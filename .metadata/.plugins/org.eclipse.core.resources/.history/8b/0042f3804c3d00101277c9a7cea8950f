function handleResponse(response) {
	var messageContainer = document.getElementById('messageContainer');
	if (response.status === 'success') {
		messageContainer.innerHTML = '<p class="success-message">' + response.message + '</p>';
	} else {
		messageContainer.innerHTML = '<p class="error-message">' + response.message + '</p>';
	}
	messageContainer.style.display = 'block'; // Show the message container
}


///// TO GIVE RECEIPT NUMBER TO ALL OF THE INPUTS IN TABLE ROW THAT ARE HIDDEN FROM THE INPUT ABOVE THE TABLE
const input1 = document.getElementById('receiptNoInput');
const input1value = input1.value;
localStorage.setItem('inputValue1', input1value);
const inputElements = document.querySelectorAll('#receiptNo');

function updateInputValues(value) {
	input1.value = value;
	inputElements.forEach((input) => {
		input.value = value;
	});
}

document.addEventListener('DOMContentLoaded', () => {
	const storedValue = localStorage.getItem('inputValue1');
	if (storedValue) {
		updateInputValues(storedValue);
		localStorage.removeItem('inputValue1');
	}
});

//input1.addEventListener('input', () => {
//	updateInputValues(input1.value);
//});

///// HIDE THE BUTTON IF THE SAVE BUTTON IS CLICKED
// Get all buttons with the specified class
const buttons = document.querySelectorAll('#saveBtn');

// Add event listeners to each button
buttons.forEach(button => {
	button.addEventListener('click', function() {
		// this.style.background = "#FF0000";
		/*this.style.display = 'none';*/
	});
});



///// TO MAKE THE TOTAL OF THE COLLECION AMOUNT FROM THE TABLE INPUT
const collectionamount = document.querySelectorAll('#collectionAmount');
//document.getElementById('total').style.display = "none"
var total;
function totalAmount() {
	total = 0
	collectionamount.forEach((input) => {
		if (input.value == "") {
			input.value = 0;
		}
		var no = parseInt(input.value);
		console.log("fhsdklfjsdlkfjflk;", no)
		total += no;
	});
	console.log("total =====total;", total)
	document.getElementById('total').style.display = "block"
	//document.getElementById('total').textContent = total;
	document.getElementById('total').value = total;
}


///// TO GET THE VALUE FROM SEND SMS CHECKBOX SWITCH TO INPUT TEXT IN FORM
document.addEventListener('DOMContentLoaded', function() {
	var switchElement = document.getElementById('switch');
	const sendSMSInput = document.querySelectorAll('#sendSMSInput');
	for (var i = 0; i < sendSMSInput.length; i++) {
		sendSMSInput[i].value = 'N';
	}
	switchElement.addEventListener('change', function() {
		var isChecked = switchElement.checked;
		var selectedValue = isChecked ? 'Y' : 'N';
		for (var i = 0; i < sendSMSInput.length; i++) {
			sendSMSInput[i].value = selectedValue;
		}
		//sendSMSInput.value = selectedValue;
	});
});



///// TO GET THE VALUE FROM ONLINE PAYMENT CHECKBOX SWITCH TO INPUT TEXT IN FORM
/*document.addEventListener('DOMContentLoaded', function() {
	var switchElement = document.getElementById('online');
	const onlinePaymentInput = document.getElementById('onlinePaymentInput');
	for (var i = 0; i < onlinePaymentInput.length; i++) {
		onlinePaymentInput[i].value = 'Offline';
	}
	switchElement.addEventListener('change', function() {
		var isChecked = switchElement.checked;
		var selectedValue = isChecked ? 'Online' : 'Offline';
		for (var i = 0; i < onlinePaymentInput.length; i++) {
			onlinePaymentInput[i].value = selectedValue;
		}
		//sendSMSInput.value = selectedValue;
	});
});*/



// Get all the checkboxes
var onlinecheckboxes = document.querySelectorAll('#online');

const onlinePaymentInput = document.querySelectorAll('#onlinePaymentInput');
for (var i = 0; i < onlinePaymentInput.length; i++) {
	onlinePaymentInput[i].value = 'Offline';
}
// Add event listener to each checkbox
onlinecheckboxes.forEach(function(checkbox) {
	checkbox.addEventListener('change', function() {
		// Get the parent row of the checkbox
		var row = this.closest('tr');

		// Get the corresponding onlinePaymentInput field in the row
		var onlinePaymentInput = row.querySelector('#onlinePaymentInput');

		// Update the value based on checkbox checked state
		if (this.checked) {
			onlinePaymentInput.value = 'Online';
		} else {
			onlinePaymentInput.value = 'Offline';
		}
	});
});


//for online and offline amount collection
document.addEventListener('DOMContentLoaded', function () {
    const onlineCheckboxes = document.querySelectorAll('.online-switch');

    onlineCheckboxes.forEach(function (checkbox) {
        const row = checkbox.closest('tr');
        const hiddenInput = row.querySelector('.online-payment-input');
        const labelSpan = row.querySelector('.payment-label');

        // Set default values
        hiddenInput.value = 'Offline';
        labelSpan.textContent = 'Offline';

        checkbox.addEventListener('change', function () {
            if (checkbox.checked) {
                hiddenInput.value = 'Online';
                labelSpan.textContent = 'Online';
            } else {
                hiddenInput.value = 'Offline';
                labelSpan.textContent = 'Offline';
            }
        });
    });
});


/***************************************************/

document.addEventListener('DOMContentLoaded', function () {
	const modal = document.getElementById('denominationModal');
	const totalDisplay = document.getElementById('totalDenomination');
	const changeDisplay = document.getElementById('changeReturn');
	const amountReceivedInput = document.getElementById('amountReceived');
	const noteInputs = document.querySelectorAll('.note');
	let currentForm = null;

	// Update denomination total and change
	function updateTotal() {
		let total = 0;
		noteInputs.forEach(input => {
			const count = parseInt(input.value) || 0;
			const value = parseInt(input.dataset.value);
			total += count * value;
		});
		totalDisplay.textContent = total;
		const received = parseFloat(amountReceivedInput.value) || 0;
		changeDisplay.textContent = (received - total).toFixed(2);
	}

	// Attach update event
	noteInputs.forEach(input => input.addEventListener('input', updateTotal));
	amountReceivedInput.addEventListener('input', updateTotal);

	// Save button click handler
	document.querySelectorAll('.saveBtn').forEach(btn => {
		btn.addEventListener('click', function (e) {
			e.preventDefault();
			currentForm = this.closest('form');
			modal.style.display = 'flex';
			updateTotal();
		});
	});

	// Confirm denomination and submit form
	document.getElementById('confirmDenomination').addEventListener('click', function () {
		modal.style.display = 'none';
		if (currentForm) {
			currentForm.submit();
		}
	});

	// Cancel
	document.getElementById('cancelDenomination').addEventListener('click', function () {
		modal.style.display = 'none';
	});
	
	// Payment switch toggle
	document.querySelectorAll('.online-switch').forEach(switchInput => {
		switchInput.addEventListener('change', function () {
			const row = this.closest('tr');
			const label = row.querySelector('.payment-label');
			const hiddenInput = row.querySelector('.online-payment-input');
			if (this.checked) {
				label.textContent = 'Online';
				hiddenInput.value = 'Online';
			} else {
				label.textContent = 'Offline';
				hiddenInput.value = 'Offline';
			}
		});
	});
});

/*******************************************************************************/

document.addEventListener('DOMContentLoaded', function() {
	const accountCode = document.querySelectorAll('#accountCode');

	//console.log("fhsdklfjsdlkfjflk;", accountCode)

	accountCode.forEach((input) => {

		const substring = input.value.substring(4, 7);

		if (substring === "901" || substring === "902" || substring === "401" || substring === "402") {
			//var collectionAmountInput = document.getElementById('collectionAmount');
			// collectionAmountInput.disabled = true;
			console.log("disable code", input.value.substring(4, 7))
			const collectionAmountInput = input.closest('tr').querySelector('#collectionAmount');
			const collsavebtn = input.closest('tr').querySelector('#saveBtn');
			// Disable the collectionAmount input if it exists
			if (collectionAmountInput) {
				collectionAmountInput.disabled = true;
				collsavebtn.disabled = true;
			}
		}

		//console.log("fhsdklfjsdlkfjflk;", input.value)

	});


	// Select the collectionAmount input element
	// var collectionAmountInput = document.getElementById('collectionAmount');

	// Ensure the accountCode is a string and check if it contains "901"
	//    collectionAmountInput.disabled = true;

});



