<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head>
	<title>कलेक्शन पेज</title>
	<style th:replace="includes/style :: style"></style>
	<link href="style/viewAgentStyle.css" rel="stylesheet" />
</head>

<body class="backgroundColor">
	<header th:replace="includes/header :: header"></header>
	<div class="container">
		<div class="row text-center">
			<div class="col-sm-12 col-md-12">
				<a href="/myapp/home" class="btn btn-info text-white float-end">पीछे जाइये</a>
			</div>
			<div class="col-sm-12 col-md-12">
				<h3 class="text-center heading" id="hehe">कलेक्शन फॉर्म</h3>

				<form th:action="@{/viewAgentList}" method="post" class="singleInputButtonForm">
					<input type="text" id="customerId" name="customerId" placeholder="ग्राहक क्रमांक"
						class=".ui-box .top-leftStart-backward" required />
					<input type="submit" class="submitBtn" value="Submit" />
				</form>

			</div>
		</div>
		<div class="row">
			<div class="col-sm-12 col-md-12 mt-4" th:if="${agentList != null}">
				<h3 class="heading text-center"> ग्राहक सूची </h3>
				<h6><b>ग्राहक क्रमांक : </b><span th:text="${agentList[0].customerId}"></span></h6>
				<div class="d-flex justify-content-between mb-2 mt-2">

					<div>
						<h6><b>ग्राहक नाम (English) : </b><span th:text="${agentList[0].name}"></span></h6>
					</div>
					<div>
						<!-- <h6><b>मोबाइल नंबर : </b><span th:text="${agentList[0].mobile}"></span></h6>-->
						<label for="mobile"><b>मोबाइल नंबर : </b></label>
						<input type="text" name="mobile" id="mobile" th:value="${agentList[0].mobile}" readonly />
					</div>
				</div>
				<div class="d-flex justify-content-between">
					<div>
						<h6><b>ग्राहक नाम (हिंदी) : <span th:utext="${agentList[0].localLanguageName}"></span></b></h6>
					</div>
					<div>
						<label for="receiptNo"><b>रसीद क्रमांक :</b></label>
						<input type="text" name="receiptNoInput" id="receiptNoInput"
							th:value="${agentList[0].receiptNo}" readonly />
					</div>
				</div>
				<div class="d-flex justify-content-between">
					<div class="form-check form-switch">
						<label class="form-check-label" for="switch">Send SMS</label>
						<input class="form-check-input" type="checkbox" id="switch">
					</div>
					<div class="form-check mt-2">
						<input class="form-check-input" type="checkbox" id="multiDenominationCheckbox"
							onchange="updateMultiDenominationFlag()">
						<label class="form-check-label" for="isMultipleDenomination"><b>मल्टीपल कलेक्शन</b></label>
						<input type="hidden" id="isMultipleDenomination" name="isMultipleDenomination" value="N" />
					</div>
				</div>
				<div id="responseMessage" class="text-center hidden"></div>

				<div class="text-center">
					<div class="table-responsive" id="table">
						<table class="table table-editable">
							<thead class="thead">
								<tr class="table-success">
									<th>खाते क्रमांक</th>
									<th>खाता प्रकार</th>
									<th>अंतिम तारीख</th>
									<th>किश्त राशि</th>
									<th>शेष राशि</th>
									<th>पेमेंट</th>
									<!--<th>मल्टीपल कलेक्शन</th>-->
									<th>कलेक्शन मात्रा</th>
									<th>सेव</th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="agent  : ${agentList}">
									<form method="post" th:action="@{/saveCollection}" th:target="hiddenFrame"
										th:object="${agentCollectionList}" id="collectionForm">
										<td th:text="${agent.accountCode}"></td>
										<td th:utext="${agent.accountType}"></td>
										<td th:text="${agent.reviewDate}"></td>
										<td th:text="${agent.installmentAmount}"></td>
										<td th:text="${agent.ledgerbalance}"></td>

										<td>
											<label><input type="radio" name="paymentMethod" value="Offline">
												Offline</label>
											&nbsp;&nbsp;
											<label><input type="radio" name="paymentMethod" value="Online">
												Online</label>
										</td>
										<input type="hidden" id="selectedPaymentMethod" name="selectedPaymentMethod" />

									


										<input type="hidden" name="customerId" th:value="${agent.customerId}" />
										<input type="hidden" id="accountCode" name="accountCode"
											th:value="${agent.accountCode}" />
										<input type="hidden" name="accountType" th:value="${agent.accountType}" />
										<input type="hidden" name="name" th:value="${agent.name}" />
										<input type="hidden" name="ledgerbalance" th:value="${agent.ledgerbalance}" />
										<td><input type="number" id="collectionAmount" name="collectionAmount" min="0"
												required /></td>
										<input type="hidden" id="latitude" name="latitude" />
										<input type="hidden" id="longitude" name="longitude" />
										<input type="hidden" id="receiptNo" name="receiptNo" />
										<input type="hidden" id="sendSMSInput" readonly />
										<!--<input type="hidden" id="isMultipleDenomination" name="isMultipleDenomination" />-->
										<!-- <input type="hidden" id="collectionResponse" name="collectionResponse"
											th:value="${isCollectionSaved}" />-->
										<td>
											<!--<input type="submit" id="saveBtn" class="btn" value="Save" />-->
											<input type="submit" id="saveBtn" class="btn" value="Save" disabled />
										</td>
									</form>
								</tr>
								<tr>
									<td></td>
									<td></td>
									<td></td>
									<td></td>
									<td></td>
									<td></td>
									<!--<td></td>-->
									<td><input type="text" id="total" name="total" disabled /></td>
									<td><button onclick="totalAmount()" class="btn btn-success"
											th:attr="data-customer-id=${agentList[0].customerId}">कुल रूपए</button></td>
								</tr>
							</tbody>
						</table>

						<!-- Denomination Modal -->
						<div id="denominationModal" class="modal" style="display: none;">
							<div class="modal-content">
								<h2 class="modal-title">Denomination Entry</h2>
								<form id="denominationForm">
									<input type="hidden" id="denominationCustomerId" name="customerId" />
									<input type="hidden" id="asondate" name="asondate"
										th:value="${#dates.format(#dates.createNow(), 'dd-MMM-yy')}" />
									<div class="denomination-grid">
										<label>₹2000: <input type="number" id="r2000" value="0" min="0"></label>
										<label>₹500: <input type="number" id="r500" value="0" min="0"></label>
										<label>₹200: <input type="number" id="r200" value="0" min="0"></label>
										<label>₹100: <input type="number" id="r100" value="0" min="0"></label>
										<label>₹50: <input type="number" id="r50" value="0" min="0"></label>
										<label>₹20: <input type="number" id="r20" value="0" min="0"></label>
										<label>₹10: <input type="number" id="r10" value="0" min="0"></label>
										<label>₹5: <input type="number" id="r5" value="0" min="0"></label>
										<label>₹2: <input type="number" id="r2" value="0" min="0"></label>
										<label>₹1: <input type="number" id="r1" value="0" min="0"></label>
									</div>

									<!--<div class="amount-summary">
										<p><strong>Total Notes Amount:</strong> ₹<span id="totalDenomination">0</span>
										</p>
										<label>Offline Amount Received:
											<input type="number" id="amountReceived" min="1" readonly>
										</label>
										<label>Online Amount:
   										 <input type="number" id="onlineAmt" name="onlineAmt" readonly>
										</label>
										<p><strong>Change to Return:</strong> ₹<span id="changeReturn">0</span></p>
									</div>-->
									<div class="amount-summary">
										<p style="font-weight: bold; color: #2a8c2a;">
											<strong>Total Notes Amount:</strong> ₹<span id="totalDenomination">0</span>
										</p>

										<label style="font-weight: bold; color: #1d3557;">
											Offline Amount Received:
											<input type="number" id="amountReceived" min="1" readonly
												style="font-weight: bold;" />
										</label>
										<br />
										<label style="font-weight: bold; color: #e76f51;">
											Online Amount Received:
											<input type="number" id="onlineAmt" name="onlineAmt" readonly
												style="font-weight: bold;" />
										</label>

										<p style="font-weight: bold; color: #e63946;">
											<strong>Change to Return:</strong> ₹<span id="changeReturn">0</span>
										</p>
									</div>



									<div class="denomination-grid">
										<label>₹2000: <input type="number" id="c2000" value="0" min="0"></label>
										<label>₹500: <input type="number" id="c500" value="0" min="0"></label>
										<label>₹200: <input type="number" id="c200" value="0" min="0"></label>
										<label>₹100: <input type="number" id="c100" value="0" min="0"></label>
										<label>₹50: <input type="number" id="c50" value="0" min="0"></label>
										<label>₹20: <input type="number" id="c20" value="0" min="0"></label>
										<label>₹10: <input type="number" id="c10" value="0" min="0"></label>
										<label>₹5: <input type="number" id="c5" value="0" min="0"></label>
										<label>₹2: <input type="number" id="c2" value="0" min="0"></label>
										<label>₹1: <input type="number" id="c1" value="0" min="0"></label>
									</div>

									<div class="modal-actions">
										<button type="button" id="confirmDenomination">✅ Confirm</button>
										<button type="button" class="cancel-button" id="cancelDenomination">❌
											Cancel</button>
									</div>

								</form>
							</div>
						</div>


						<!--<ul class="nav justify-content-center row">
							<li class="nav-item">
								<button onclick="totalAmount()" class="btn btn-success">कुल रूपए</button>
							</li>
							<p id="total" class="nav-item"></p>
						</ul>
						<div class="d-flex justify-content-end gap-3">

							<div class="float-left">
								<button onclick="totalAmount()" class="btn btn-success">कुल रूपए</button>
							</div>
							<div class="ml-4">
								
								<input type="text" id="total" name="total" disabled />
							</div>
						</div>-->
					</div>
				</div>
			</div>
			<iframe id="hiddenFrame" name="hiddenFrame" style="display: none;"
				onload="handleResponse(JSON.parse(this.contentDocument.body.innerText))"></iframe>
			<div id="messageContainer"></div>


		</div>
	</div>
	<script th:replace="includes/script :: script"></script>
	<script src="script/viewAgentScript.js"></script>
	<script th:if="${isDataMissing != null}" th:inline="javascript">
		alert("No data available!");
	</script>
	<script th:if="${isCollectionSaved != null}" th:inline="javascript">
		//alert(th:text = "${isCollectionSaved}");
		alert([[${#strings.escapeJavaScript(isCollectionSaved)}]]);
	</script>
	<script src="script/location.js"></script>
	<script src="script/idNameSwitchBtn.js"></script>


	<!--<footer th:replace="includes/footer :: footer"></footer>-->
</body>

</html>